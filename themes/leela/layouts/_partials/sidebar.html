<button class="sidebar-toggle" aria-label="Toggle navigation">
  <span class="material-symbols--arrow-menu-open-rounded"></span>
  <span class="sidebar-toggle-text">Section Menu</span>
</button>
<div class="sidebar-overlay"></div>
<nav class="sidebar">    
<div class="sidebar-header">
    <span class="material-symbols--close"></span>
<h4>{{ .Section | humanize }}</h4>
</div>
<ul>
    {{$defaultLangVersion := index .AllTranslations 0 | default .}}
    {{template "submenu" dict "sect" $defaultLangVersion.FirstSection "docId" .File.UniqueID "currentLang" .Language.Lang}}
</ul>
</nav>

{{define "submenu"}}
    {{$docId := .docId}}
    {{$currentLang := .currentLang}}
    {{with .sect}}
        {{ range .CurrentSection.Pages.ByWeight }}
            {{/* Get the best available version of this page */}}
            {{$displayPage := .}}
            {{if not (eq .Language.Lang $currentLang)}}
                {{range .Translations}}
                    {{if eq .Language.Lang $currentLang}}
                        {{$displayPage = .}}
                    {{end}}
                {{end}}
            {{end}}

            <li>
                {{ if $displayPage.Content }}
                    <a class="{{ if eq .File.UniqueID $docId }}active {{ end }}" href="{{ $displayPage.Permalink }}">
                        {{ $displayPage.Title }}
                        {{ if not (eq $displayPage.Language.Lang $currentLang) }}
                            <span class="lang-indicator">({{ $displayPage.Language.Lang }})</span>
                        {{ end }}
                    </a>
                {{ else }}
                    <span class="nonselectable">{{ $displayPage.Title }}</span>
                {{ end }}
            </li>

            {{ if .Pages }}
                <li>
                    <ul class="nested">
                        {{template "submenu" dict "sect" . "docId" $docId "currentLang" $currentLang}}
                    </ul>
                </li>
            {{ end }}
        {{ end }}
    {{ end }}
{{ end }}